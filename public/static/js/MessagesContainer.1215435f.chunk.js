(this["webpackJsonpit-near"]=this["webpackJsonpit-near"]||[]).push([[2],{387:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a(0),r=a.n(s),o=a(29),i=a(197),c=a(63),l=a(61),m=a(444),d=a(48),p=a(13),g=a(41),u=a(128),b=a.n(u),f=a(378),h=a(576),v=a(438),x=a(422),E=a(434),w=a(35),y=a(66),j=a.n(y),O=a(204),I=a(11),k=Object(O.a)((function(e){return{dialog:{"&:not(:last-of-type)":{borderBottom:"1px solid ".concat(e.palette.grey[200])}},active:{background:"#efefef"},newMessages:Object(p.a)({background:e.palette.secondary.main,color:e.palette.common.white,height:20,display:"flex",padding:"0 6px",zIndex:1,position:"absolute",flexWrap:"wrap",fontSize:11,minWidth:20,boxSizing:"border-box",alignItems:"center",fontWeight:500,lineHeight:1,alignContent:"center",borderRadius:10,flexDirection:"row",right:10},e.breakpoints.up(769),{right:2}),date:{fontSize:12,color:e.palette.grey[400]},openIcon:Object(p.a)({transform:"scale(-1)",color:e.palette.primary.light,width:21},e.breakpoints.up(769),{display:"none"}),withNewMessages:Object(p.a)({paddingRight:35},e.breakpoints.up(769),{paddingRight:25})}})),M=Object(I.a)(k,{withTheme:!0}),N=a(34),S=M((function(e){var t=e.classes,a=e.user,n=a.id,s=a.userName,o=a.photos,i=a.hasNewMessages,c=a.newMessagesCount,l=a.lastDialogActivityDate,m=new Date(l).toLocaleDateString(),d=null!==o.small?o.small:b.a;return r.a.createElement(f.a,{button:!0,component:g.b,to:w.a.dialogs.getPath(n),activeClassName:t.active,className:j()(t.dialog,Object(p.a)({},t.withNewMessages,c>0))},r.a.createElement(h.a,null,r.a.createElement(v.a,{src:d,alt:s,sizes:"40"})),r.a.createElement(x.a,{primary:"@"+s,secondary:m,primaryTypographyProps:{noWrap:!0},classes:{secondary:t.date}}),i&&r.a.createElement("span",{className:t.newMessages}," ",c>99?"99+":c),r.a.createElement(E.a,{mdUp:!0},!i&&r.a.createElement(N.u,{className:t.openIcon})))})),D=a(26),z=a(50),L=a(546),T=a(76),R=a(437),B=a(577),C=a(578),F=a(579),U=a(548),W=a.n(U),$=a(549),A=a.n($),P=Object(O.a)((function(e){return{message:Object(p.a)({marginBottom:25,fontSize:16,fontWeight:400,position:"relative",maxWidth:"80%",display:"flex",alignItems:"flex-end"},e.breakpoints.up("sm"),{marginBottom:30}),avatar:{height:40,width:40},messageSended:{alignSelf:"flex-end",paddingLeft:22,flexDirection:"row-reverse","& $messageItem":{background:"#3d4977",color:"#fff",borderBottomRightRadius:0},"& $avatar":{marginLeft:10},"& $viewedIcon":{right:55},"& $actionBtn":{left:0},"& $date":{right:50}},messageRecieved:{paddingRight:22,"& $messageItem":{background:"#efefef",borderBottomLeftRadius:0},"& $avatar":{marginRight:10},"& $viewedIcon":{left:55,filter:"invert(0.5)"},"& $actionBtn":{right:0},"& $date":{left:50}},messageInactive:{"& $messageItem":{background:"#eee",color:"grey",fontSize:"12px"},"& $viewedIcon":{display:"none"}},messageItem:{fontSize:"0.9rem",padding:"9px 15px",borderRadius:"10px"},viewedIcon:{position:"absolute",bottom:"2px",height:"12px"},messageIcon:{maxWidth:17,maxHeight:17,opacity:"0.5"},actionBtn:{cursor:"pointer",width:20,height:20,position:"absolute",background:"transparent",padding:2,boxSizing:"border-box",border:"none",display:"flex",alignItems:"center","&:hover $messageIcon":{opacity:1}},delete:{top:0},restore:{top:0,bottom:0,margin:"auto 0"},spam:{top:20},date:Object(p.a)({position:"absolute",bottom:"-20px",fontSize:11,color:e.palette.grey[400],letterSpacing:"-0.4px",whiteSpace:"nowrap"},e.breakpoints.up(480),{fontSize:12})}})),G=Object(I.a)(P,{withTheme:!0})((function(e){var t=e.message,a=e.deleteMessage,n=e.spamMessage,s=e.restoreMessage,o=e.deletedMessages,i=e.spamedMessages,c=e.selectedFriend,l=e.currentUserInfo,m=e.classes,d=t.addedAt,p=t.body,u=t.id,f=t.senderId,h=t.viewed,x=o.includes(u),E=i.includes(u),y=x||E,O=f===l.userId,I=function(e){return new Date(e).toLocaleTimeString().split(":").slice(0,-1).join(":")}(d),k=x?"Message was deleted":"Message added to spam";return r.a.createElement("div",{className:j()(m.message,O?m.messageSended:m.messageRecieved,y?m.messageInactive:"")},r.a.createElement(v.a,{component:g.b,to:w.a.profile.getPath(f),src:!O&&c?c.photos.small||b.a:O&&l.photos.small||b.a,alt:"avatar",sizes:"40",className:m.avatar}),r.a.createElement(T.a,{variant:"body2",className:m.messageItem,component:"div"},y?k:r.a.createElement(L.a,null,p)),r.a.createElement("img",{src:h?W.a:A.a,alt:"",className:m.viewedIcon}),r.a.createElement("div",{className:m.date},I),!y&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:j()(m.actionBtn,m.delete),onClick:function(){return a(u)}},r.a.createElement(R.a,{title:"Delete","aria-label":"Delete"},r.a.createElement(B.a,{color:"primary",className:m.messageIcon}))),!O&&r.a.createElement("button",{className:j()(m.actionBtn,m.spam),onClick:function(){return n(u)}},r.a.createElement(R.a,{title:"Spam","aria-label":"Spam"},r.a.createElement(C.a,{color:"primary",className:m.messageIcon})))),y&&r.a.createElement("button",{className:j()(m.actionBtn,m.restore),onClick:function(){return s(u)}},r.a.createElement(R.a,{title:"Restore","aria-label":"Restore"},r.a.createElement(F.a,{color:"primary",className:m.messageIcon}))))})),H=a(241),J=a(242),Y=a(441),q=a(423),K=Object(O.a)((function(e){return{form:Object(p.a)({display:"flex",backgroundColor:"#f3f5f7",padding:10},e.breakpoints.up(769),{padding:30}),root:{flexGrow:1,marginBottom:0},textarea:Object(p.a)({borderRadius:0,backgroundColor:"white"},e.breakpoints.down(769),{padding:"10px 14px"}),button:{height:"100%",borderRadius:0}}})),Q=Object(I.a)(K,{withTheme:!0}),V=Object(J.a)({form:"message"})(Q((function(e){var t=e.handleSubmit,a=e.submitting,n=e.classes;return r.a.createElement("form",{className:n.form,onSubmit:t},r.a.createElement(H.a,{name:"message",type:"textarea",component:Y.a,placeholder:"Type message...",required:!0,classes:{root:n.root},InputProps:{className:n.textarea},variant:"outlined",multiline:!0,rowsMax:"2"}),r.a.createElement(q.a,{type:"submit",disabled:a,className:n.button,color:"primary",variant:"contained"},r.a.createElement(N.G,null)))}))),X=a(91),Z=a(417),_=a(414),ee=a(459),te=Object(O.a)((function(e){var t;return{head:(t={display:"flex",alignItems:"center",fontSize:"12px",position:"absolute",top:0,left:0,right:0,padding:"5px 30px 5px 47px",zIndex:2,backgroundColor:e.palette.common.white},Object(p.a)(t,e.breakpoints.up(769),{padding:"11px 30px"}),Object(p.a)(t,"&::after",{position:"absolute",bottom:"0",left:"0",right:"0",content:"''",height:"1px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2)"}),t),headInfo:{marginLeft:15,flexGrow:1},headLink:{color:e.palette.text.primary,"&:hover":{color:e.palette.primary.main}},headDate:Object(p.a)({color:e.palette.grey[400]},e.breakpoints.down(480),{fontSize:11}),back:Object(p.a)({position:"absolute",left:0},e.breakpoints.up(769),{display:"none"})}})),ae=Object(I.a)(te,{withTheme:!0})((function(e){var t=e.classes,a=e.lastUserActivityDate,n=e.selectedFriend,s=e.messagesLoading;return r.a.createElement("div",{className:t.head},r.a.createElement(E.a,{mdUp:!0},r.a.createElement(Z.a,{color:"primary","aria-label":"Back",edge:"end",component:g.b,className:t.back,to:w.a.dialogs.getPath(null)},r.a.createElement(N.u,null))),s?r.a.createElement(ee.a,{animation:"wave",variant:"circle",height:40,width:40}):r.a.createElement(v.a,{src:n.photos.small||b.a,component:g.b,to:w.a.profile.getPath(n.userId),alt:"avatar",sizes:"40"}),r.a.createElement("div",{className:t.headInfo},s?r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.a,{animation:"wave",width:"80%",className:"MuiTypography-subtitle1"}),r.a.createElement(ee.a,{animation:"wave",width:"50%",height:13,className:"MuiTypography-body2"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{component:g.b,to:w.a.profile.getPath(n.userId),underline:"none",className:t.headLink},r.a.createElement(T.a,{variant:"subtitle1",component:"h6"},n.fullName)),a&&r.a.createElement("div",{className:t.headDate},"Was here: ",new Date(a).toLocaleString()))))})),ne=Object(O.a)((function(e){return{chat:{position:"relative",paddingTop:"68px",display:"flex",flexDirection:"column",height:"100%"},chatWrapper:{position:"relative",display:"flex",flexDirection:"column",alignItems:"flex-start",flexGrow:1,overflowY:"auto",padding:"0 10px 20px"},date:Object(p.a)({color:e.palette.grey[400],margin:"5px auto"},e.breakpoints.up("sm"),{margin:"15px auto"})}})),se=Object(I.a)(ne,{withTheme:!0})((function(e){var t=e.classes,a=e.friendId,n=e.messages,o=e.deleteMessage,i=e.spamMessage,c=e.lastUserActivityDate,l=e.restoreMessage,m=e.getMessages,d=e.sendMessage,p=e.deletedMessages,g=e.spamedMessages,u=e.selectedFriend,b=e.currentUserInfo,f=e.messagesLoading,h=Object(s.useState)([]),v=Object(z.a)(h,2),x=v[0],E=v[1];Object(s.useEffect)((function(){a&&void 0!==a&&m(a)}),[a]),Object(s.useEffect)((function(){!function(){var e={};n.map((function(t){var a=new Date(t.addedAt).toLocaleDateString();e[a]?e[a]=[].concat(Object(D.a)(e[a]),[t]):e[a]=[t]}));var t=[];Object.entries(e).map((function(e){t=[].concat(Object(D.a)(t),[{date:e[0],messages:e[1]}])})),E(t)}()}),[n]),Object(s.useEffect)((function(){f||w()}),[f,x]);var w=function(){var e=document.getElementById("wrapper");e&&e.scroll(0,e.scrollHeight-e.clientHeight)};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.chat},u&&r.a.createElement(ae,{lastUserActivityDate:c,selectedFriend:u,messagesLoading:f}),r.a.createElement("div",{className:t.chatWrapper,id:"wrapper"},f?r.a.createElement(X.a,{showPreloader:!0}):x.map((function(e){var a=e.date,n=e.messages;return r.a.createElement(s.Fragment,{key:a},r.a.createElement("div",{className:t.date},a),n.map((function(e){return r.a.createElement(G,{key:e.id,message:e,deleteMessage:o,spamMessage:i,restoreMessage:l,deletedMessages:p,spamedMessages:g,selectedFriend:u,currentUserInfo:b})})))}))),r.a.createElement(V,{onSubmit:function(e){var t=e.message;d(a,t)}})))})),re=a(122),oe=a(412),ie=a(550),ce=a.n(ie),le=Object(O.a)((function(e){return{empty:{width:"100%",height:"100%",padding:30,display:"flex",flexDirection:"column"},emptyImg:{background:"url(".concat(ce.a,") no-repeat center"),backgroundSize:"contain",flexGrow:1},emptyText:{margin:"30px 0",textAlign:"center"}}})),me=Object(I.a)(le,{withTheme:!0})((function(e){var t=e.classes;return r.a.createElement("div",{className:t.empty},r.a.createElement("div",{className:t.emptyImg}),r.a.createElement(E.a,{mdDown:!0},r.a.createElement("div",{className:t.emptyText},r.a.createElement(T.a,{variant:"h6"},"Select conversation to display"),r.a.createElement(T.a,{variant:"body2"},"To start a new conversation just click the message button from a person profile"))))})),de=Object(O.a)((function(e){var t;return{root:Object(p.a)({flexGrow:1,padding:"20px 0",display:"flex",alignItems:"center"},e.breakpoints.up("md"),{padding:"20px 0"}),paper:{width:"100%",height:"calc(100vh - 130px)",display:"flex",background:"#ffffff",borderRadius:0,position:"relative"},list:(t={borderRight:"1px solid #eeeeee",backgroundColor:e.palette.background.paper,overflow:"auto",maxHeight:"100%",padding:0},Object(p.a)(t,e.breakpoints.down(769),{background:"rgba(255, 255, 255, 0.8)",position:"absolute",left:0,width:"100%",top:0,bottom:0,zIndex:2}),Object(p.a)(t,e.breakpoints.up(769),{width:250,minWidth:250}),Object(p.a)(t,e.breakpoints.up("md"),{width:300,minWidth:300}),t),hiddenList:Object(p.a)({},e.breakpoints.down(769),{left:"calc(-100% - 30px)"}),content:{flexGrow:1,position:"relative"}}})),pe=Object(I.a)(de,{withTheme:!0})((function(e){var t=e.classes,a=e.messages,n=e.deletedMessages,s=e.dialogs,o=e.sendMessage,i=e.getMessages,c=e.deleteMessage,l=e.spamMessage,m=e.lastUserActivityDate,d=e.restoreMessage,g=e.spamedMessages,u=e.selectedFriend,b=e.currentUserInfo,f=e.friendId,h=e.messagesLoading;return r.a.createElement("div",{className:t.root},r.a.createElement(re.a,{className:t.paper,elevation:3},r.a.createElement(oe.a,{className:j()(t.list,Object(p.a)({},t.hiddenList,f)),component:"div"},s.map((function(e){return r.a.createElement(S,{key:e.id,user:e})}))),r.a.createElement("div",{className:t.content},b&&f?r.a.createElement(se,{messagesLoading:h,deletedMessages:n,spamedMessages:g,messages:a,friendId:f,sendMessage:o,getMessages:i,deleteMessage:c,spamMessage:l,lastUserActivityDate:m,restoreMessage:d,selectedFriend:u,currentUserInfo:b}):r.a.createElement(me,null))))})),ge=a(71);t.default=Object(d.d)(Object(l.b)((function(e){return{messages:Object(i.d)(e),dialogs:Object(i.b)(e),lastUserActivityDate:Object(i.c)(e),deletedMessages:Object(i.a)(e),spamedMessages:Object(i.h)(e),selectedFriend:Object(i.g)(e),currentUserInfo:Object(c.c)(e),messagesLoading:Object(i.e)(e)}}),{sendMessage:o.s,getDialogs:o.n,getMessages:o.o,deleteMessage:o.m,spamMessage:o.z,restoreMessage:o.r}),m.a)((function(e){var t=e.getDialogs,a=Object(n.a)(e,["getDialogs"]),o=Object(ge.i)().id;return Object(s.useEffect)((function(){t()}),[]),r.a.createElement(pe,Object.assign({},a,{friendId:Number(o)}))}))},441:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(3),s=a(13),r=a(0),o=a.n(r),i=a(199),c=a(584),l=a(573),m=a(587),d=a(574),p=["text","email","search","password","textarea"],g=Object(i.a)((function(e){return{textInput:{marginBottom:25,"& .MuiFormHelperText-root":Object(s.a)({fontSize:10,position:"absolute",bottom:0,transform:"translateY(100%)"},e.breakpoints.up("sm"),{fontSize:12})}}})),u=function(e){var t=e.input,a=e.label,s=e.type,r=e.meta,i=r.touched,u=r.error,b=Object(n.a)(e,["input","label","type","meta"]),f=g();return o.a.createElement(o.a.Fragment,null,p.includes(s)&&o.a.createElement(c.a,Object.assign({error:i&&Boolean(u),helperText:i&&u?u:"",label:a,type:s,fullWidth:!0,className:f.textInput},t,b)),"checkbox"===s&&o.a.createElement(l.a,{className:f.textInput,control:o.a.createElement(m.a,{checked:!!t.value,onChange:t.onChange}),label:a}),"switch"===s&&o.a.createElement(l.a,{className:f.textInput,control:o.a.createElement(d.a,{checked:!!t.value,onChange:t.onChange}),label:a}))}},444:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(78),s=a(57),r=a(131),o=a(132),i=a(133),c=a(0),l=a.n(c),m=a(71),d=a(61),p=a(63),g=a(35),u=function(e){return{isAuth:Object(p.e)(e)}},b=function(e){var t=function(t){function a(){return Object(n.a)(this,a),Object(r.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(i.a)(a,t),Object(s.a)(a,[{key:"render",value:function(){return this.props.isAuth?l.a.createElement(e,this.props):l.a.createElement(m.a,{to:g.a.login.path})}}]),a}(c.Component);return Object(d.b)(u)(t)}},548:function(e,t,a){e.exports=a.p+"static/media/read.3f77ca25.svg"},549:function(e,t,a){e.exports=a.p+"static/media/unread.4cd435c4.svg"},550:function(e,t,a){e.exports=a.p+"static/media/chat-bg.6cc5a933.svg"}}]);
//# sourceMappingURL=MessagesContainer.1215435f.chunk.js.map