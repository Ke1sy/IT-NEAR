(this["webpackJsonpit-near"]=this["webpackJsonpit-near"]||[]).push([[2],{443:function(e,t,a){"use strict";a.r(t);var n=a(3),s=a(0),r=a.n(s),o=a(29),i=a(108),c=a(58),l=a(62),d=a(500),m=a(47),g=a(13),p=a(41),u=a(140),b=a.n(u),f=a(434),h=a(628),v=a(494),x=a(478),w=a(490),j=a(34),E=a(66),y=a.n(E),O=a(228),M=a(11),I=Object(O.a)((function(e){return{dialog:{"&:not(:last-of-type)":{borderBottom:"1px solid ".concat(e.palette.grey[200])}},active:{background:"#efefef"},newMessages:Object(g.a)({background:e.palette.secondary.main,color:e.palette.common.white,height:20,display:"flex",padding:"0 6px",zIndex:1,position:"absolute",flexWrap:"wrap",fontSize:11,minWidth:20,boxSizing:"border-box",alignItems:"center",fontWeight:500,lineHeight:1,alignContent:"center",borderRadius:10,flexDirection:"row",right:10},e.breakpoints.up(769),{right:2}),date:{fontSize:12,color:e.palette.grey[400]},openIcon:Object(g.a)({transform:"scale(-1)",color:e.palette.primary.light,width:21},e.breakpoints.up(769),{display:"none"}),withNewMessages:Object(g.a)({paddingRight:35},e.breakpoints.up(769),{paddingRight:25})}})),k=Object(M.a)(I,{withTheme:!0}),N=a(31),D=k((function(e){var t=e.classes,a=e.user,n=a.id,s=a.userName,o=a.photos,i=a.hasNewMessages,c=a.newMessagesCount,l=a.lastDialogActivityDate,d=new Date(l).toLocaleDateString(),m=null!==o.small?o.small:b.a;return r.a.createElement(f.a,{button:!0,component:p.b,to:j.a.dialogs.getPath(n),activeClassName:t.active,className:y()(t.dialog,Object(g.a)({},t.withNewMessages,c>0))},r.a.createElement(h.a,null,r.a.createElement(v.a,{src:m,alt:s,sizes:"40"})),r.a.createElement(x.a,{primary:"@"+s,secondary:d,primaryTypographyProps:{noWrap:!0},classes:{secondary:t.date}}),i&&r.a.createElement("span",{className:t.newMessages}," ",c>99?"99+":c),r.a.createElement(w.a,{mdUp:!0},!i&&r.a.createElement(N.u,{className:t.openIcon})))})),S=a(26),z=a(50),C=a(602),L=a(77),R=a(493),T=a(629),B=a(630),F=a(631),U=a(604),W=a.n(U),$=a(605),A=a.n($),_=Object(O.a)((function(e){return{message:Object(g.a)({marginBottom:25,fontSize:16,fontWeight:400,position:"relative",maxWidth:"80%",display:"flex",alignItems:"flex-end"},e.breakpoints.up("sm"),{marginBottom:30}),avatar:{height:40,width:40},messageSended:{alignSelf:"flex-end",paddingLeft:22,flexDirection:"row-reverse","& $messageItem":{background:"#3d4977",color:"#fff",borderBottomRightRadius:0},"& $avatar":{marginLeft:10},"& $viewedIcon":{right:55},"& $actionBtn":{left:0},"& $date":{right:50}},messageRecieved:{paddingRight:22,"& $messageItem":{background:"#efefef",borderBottomLeftRadius:0},"& $avatar":{marginRight:10},"& $viewedIcon":{left:55,filter:"invert(0.5)"},"& $actionBtn":{right:0},"& $date":{left:50}},messageInactive:{"& $messageItem":{background:"#eee",color:"grey",fontSize:"12px"},"& $viewedIcon":{display:"none"}},messageItem:{fontSize:"0.9rem",padding:"9px 15px",borderRadius:"10px",wordBreak:"break-word"},viewedIcon:{position:"absolute",bottom:"2px",height:"12px"},messageIcon:{maxWidth:17,maxHeight:17,opacity:"0.5"},actionBtn:{cursor:"pointer",width:20,height:20,position:"absolute",background:"transparent",padding:2,boxSizing:"border-box",border:"none",display:"flex",alignItems:"center","&:hover $messageIcon":{opacity:1}},delete:{top:0},restore:{top:0,bottom:0,margin:"auto 0"},spam:{top:20},date:Object(g.a)({position:"absolute",bottom:"-20px",fontSize:11,color:e.palette.grey[400],letterSpacing:"-0.4px",whiteSpace:"nowrap"},e.breakpoints.up(480),{fontSize:12})}})),P=Object(M.a)(_,{withTheme:!0})((function(e){var t=e.message,a=e.deleteMessage,n=e.spamMessage,s=e.restoreMessage,o=e.deletedMessages,i=e.spamedMessages,c=e.selectedFriend,l=e.currentUserInfo,d=e.classes,m=t.addedAt,g=t.body,u=t.id,f=t.senderId,h=t.viewed,x=o.includes(u),w=i.includes(u),E=x||w,O=f===l.userId,M=function(e){return new Date(e).toLocaleTimeString().split(":").slice(0,-1).join(":")}(m),I=x?"Message was deleted":"Message added to spam";return r.a.createElement("div",{className:y()(d.message,O?d.messageSended:d.messageRecieved,E?d.messageInactive:"")},r.a.createElement(v.a,{component:p.b,to:j.a.profile.getPath(f),src:!O&&c?c.photos.small||b.a:O&&l.photos.small||b.a,alt:"avatar",sizes:"40",className:d.avatar}),r.a.createElement(L.a,{variant:"body2",className:d.messageItem,component:"div"},E?I:r.a.createElement(C.a,null,g)),O&&r.a.createElement("img",{src:h?W.a:A.a,alt:"",className:d.viewedIcon}),r.a.createElement("div",{className:d.date},M),!E&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:y()(d.actionBtn,d.delete),onClick:function(){return a(u)}},r.a.createElement(R.a,{title:"Delete","aria-label":"Delete"},r.a.createElement(T.a,{color:"primary",className:d.messageIcon}))),!O&&r.a.createElement("button",{className:y()(d.actionBtn,d.spam),onClick:function(){return n(u)}},r.a.createElement(R.a,{title:"Spam","aria-label":"Spam"},r.a.createElement(B.a,{color:"primary",className:d.messageIcon})))),E&&r.a.createElement("button",{className:y()(d.actionBtn,d.restore),onClick:function(){return s(u)}},r.a.createElement(R.a,{title:"Restore","aria-label":"Restore"},r.a.createElement(F.a,{color:"primary",className:d.messageIcon}))))})),G=a(267),q=a(268),H=a(497),J=a(479),Y=Object(O.a)((function(e){return{form:Object(g.a)({display:"flex",backgroundColor:"#f3f5f7",padding:10},e.breakpoints.up(769),{padding:30}),root:{flexGrow:1,marginBottom:0},textarea:Object(g.a)({borderRadius:0,backgroundColor:"white"},e.breakpoints.down(769),{padding:"10px 14px"}),button:{height:"100%",borderRadius:0}}})),K=Object(M.a)(Y,{withTheme:!0}),Q=Object(q.a)({form:"message"})(K((function(e){var t=e.handleSubmit,a=e.submitting,n=e.classes;return r.a.createElement("form",{className:n.form,onSubmit:t},r.a.createElement(G.a,{name:"message",type:"textarea",component:H.a,placeholder:"Type message...",required:!0,classes:{root:n.root},InputProps:{className:n.textarea},variant:"outlined",multiline:!0,rowsMax:"2"}),r.a.createElement(J.a,{type:"submit",disabled:a,className:n.button,color:"primary",variant:"contained"},r.a.createElement(N.G,null)))}))),V=a(96),X=a(473),Z=a(470),ee=a(515),te=Object(O.a)((function(e){var t;return{head:(t={display:"flex",alignItems:"center",fontSize:"12px",position:"absolute",top:0,left:0,right:0,padding:"5px 30px 5px 47px",zIndex:2,backgroundColor:e.palette.common.white},Object(g.a)(t,e.breakpoints.up(769),{padding:"11px 30px"}),Object(g.a)(t,"&::after",{position:"absolute",bottom:"0",left:"0",right:"0",content:"''",height:"1px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2)"}),t),headInfo:{marginLeft:15,flexGrow:1},headLink:{color:e.palette.text.primary,"&:hover":{color:e.palette.primary.main}},headDate:Object(g.a)({color:e.palette.grey[400]},e.breakpoints.down(480),{fontSize:10}),back:Object(g.a)({position:"absolute",left:0},e.breakpoints.up(769),{display:"none"})}})),ae=Object(M.a)(te,{withTheme:!0})((function(e){var t=e.classes,a=e.lastUserActivityDate,n=e.selectedFriend,s=e.messagesLoading;return r.a.createElement("div",{className:t.head},r.a.createElement(w.a,{mdUp:!0},r.a.createElement(X.a,{color:"primary","aria-label":"Back",edge:"end",component:p.b,className:t.back,to:j.a.dialogs.getPath(null)},r.a.createElement(N.u,null))),s?r.a.createElement(ee.a,{animation:"wave",variant:"circle",height:40,width:40}):r.a.createElement(v.a,{src:n.photos.small||b.a,component:p.b,to:j.a.profile.getPath(n.userId),alt:"avatar",sizes:"40"}),r.a.createElement("div",{className:t.headInfo},s?r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.a,{animation:"wave",width:"80%",className:"MuiTypography-subtitle1"}),r.a.createElement(ee.a,{animation:"wave",width:"50%",height:13,className:"MuiTypography-body2"})):r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,{component:p.b,to:j.a.profile.getPath(n.userId),underline:"none",className:t.headLink},r.a.createElement(L.a,{variant:"subtitle1",component:"h6"},n.fullName)),a&&r.a.createElement("div",{className:t.headDate},"Was here: ",new Date(a).toLocaleString()))))})),ne=Object(O.a)((function(e){return{chat:{position:"relative",paddingTop:"68px",display:"flex",flexDirection:"column",height:"100%"},chatWrapper:{position:"relative",display:"flex",flexDirection:"column",alignItems:"flex-start",flexGrow:1,overflowY:"auto",padding:"0 10px 20px"},date:Object(g.a)({color:e.palette.grey[400],margin:"5px auto"},e.breakpoints.up("sm"),{margin:"15px auto"})}})),se=Object(M.a)(ne,{withTheme:!0}),re=a(91),oe=se((function(e){var t=e.classes,a=e.friendId,n=e.messages,o=e.deleteMessage,i=e.spamMessage,c=e.lastUserActivityDate,l=e.restoreMessage,d=e.getMessages,m=e.sendMessage,g=e.deletedMessages,p=e.spamedMessages,u=e.selectedFriend,b=e.currentUserInfo,f=e.messagesLoading,h=e.requestNewMessagesCount,v=e.getDialogs,x=Object(s.useState)([]),w=Object(z.a)(x,2),j=w[0],E=w[1],y=Object(s.useRef)(null),O=function(){a&&d(a)},M=function(e){e.sender.id===a&&O()},I=function(e){e===a?O():e===b.userId&&(h(),v())};Object(s.useEffect)((function(){if(a)return O(),re.d.on("get_new_message",M),re.d.on("need_update_messages",I),function(){re.d.off("get_new_message",M),re.d.off("need_update_messages",I)}}),[a]),Object(s.useEffect)((function(){!function(){var e={};n.map((function(t){var a=new Date(t.addedAt).toLocaleDateString();e[a]?e[a]=[].concat(Object(S.a)(e[a]),[t]):e[a]=[t]}));var t=[];Object.entries(e).map((function(e){t=[].concat(Object(S.a)(t),[{date:e[0],messages:e[1]}])})),E(t)}(),n.filter((function(e){return!e.viewed&&e.recipientId===b.userId})).length&&Object(re.c)({reciever:a,sender:b.userId})}),[n]),Object(s.useEffect)((function(){if(!f){var e=y.current;e.scroll(0,e.scrollHeight-e.clientHeight)}}),[f,j]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t.chat},u&&r.a.createElement(ae,{lastUserActivityDate:c,selectedFriend:u,messagesLoading:f}),r.a.createElement("div",{className:t.chatWrapper,ref:y},f?r.a.createElement(V.a,{showPreloader:!0}):j.map((function(e){var a=e.date,n=e.messages;return r.a.createElement(s.Fragment,{key:a},r.a.createElement("div",{className:t.date},a),n.map((function(e){return r.a.createElement(P,{key:e.id,message:e,deleteMessage:o,spamMessage:i,restoreMessage:l,deletedMessages:g,spamedMessages:p,selectedFriend:u,currentUserInfo:b})})))}))),r.a.createElement(Q,{onSubmit:function(e){var t=e.message;m(a,{id:b.userId,name:b.fullName},t)}})))})),ie=a(134),ce=a(468),le=a(606),de=a.n(le),me=Object(O.a)((function(e){return{empty:{width:"100%",height:"100%",padding:30,display:"flex",flexDirection:"column"},emptyImg:{background:"url(".concat(de.a,") no-repeat center"),backgroundSize:"contain",flexGrow:1},emptyText:{margin:"30px 0",textAlign:"center"}}})),ge=Object(M.a)(me,{withTheme:!0})((function(e){var t=e.classes;return r.a.createElement("div",{className:t.empty},r.a.createElement("div",{className:t.emptyImg}),r.a.createElement(w.a,{mdDown:!0},r.a.createElement("div",{className:t.emptyText},r.a.createElement(L.a,{variant:"h6"},"Select conversation to display"),r.a.createElement(L.a,{variant:"body2"},"To start a new conversation just click the message button from a person profile"))))})),pe=Object(O.a)((function(e){var t;return{root:Object(g.a)({flexGrow:1,padding:"20px 0",display:"flex",alignItems:"center"},e.breakpoints.up("md"),{padding:"20px 0"}),paper:{width:"100%",height:"calc(100vh - 130px)",display:"flex",background:"#ffffff",borderRadius:0,position:"relative"},list:(t={borderRight:"1px solid #eeeeee",backgroundColor:e.palette.background.paper,overflow:"auto",maxHeight:"100%",padding:0},Object(g.a)(t,e.breakpoints.down(769),{background:"rgba(255, 255, 255, 0.8)",position:"absolute",left:0,width:"100%",top:0,bottom:0,zIndex:2}),Object(g.a)(t,e.breakpoints.up(769),{width:250,minWidth:250}),Object(g.a)(t,e.breakpoints.up("md"),{width:300,minWidth:300}),t),hiddenList:Object(g.a)({},e.breakpoints.down(769),{left:"calc(-100% - 30px)"}),content:{flexGrow:1,position:"relative",maxWidth:"100%"}}})),ue=Object(M.a)(pe,{withTheme:!0})((function(e){var t=e.classes,a=e.messages,n=e.deletedMessages,s=e.dialogs,o=e.sendMessage,i=e.getMessages,c=e.deleteMessage,l=e.spamMessage,d=e.lastUserActivityDate,m=e.restoreMessage,p=e.spamedMessages,u=e.selectedFriend,b=e.currentUserInfo,f=e.friendId,h=e.messagesLoading,v=e.requestNewMessagesCount,x=e.getDialogs;return r.a.createElement("div",{className:t.root},r.a.createElement(ie.a,{className:t.paper,elevation:3},r.a.createElement(ce.a,{className:y()(t.list,Object(g.a)({},t.hiddenList,f)),component:"div"},s.map((function(e){return r.a.createElement(D,{key:e.id,user:e})}))),r.a.createElement("div",{className:t.content},b&&f?r.a.createElement(oe,{messagesLoading:h,deletedMessages:n,spamedMessages:p,messages:a,friendId:f,sendMessage:o,getMessages:i,deleteMessage:c,spamMessage:l,lastUserActivityDate:d,restoreMessage:m,selectedFriend:u,currentUserInfo:b,requestNewMessagesCount:v,getDialogs:x}):r.a.createElement(ge,null))))})),be=a(72),fe=o.j.sendMessage,he=o.j.getDialogs,ve=o.j.getMessages,xe=o.j.deleteMessage,we=o.j.spamMessage,je=o.j.restoreMessage,Ee=o.j.requestNewMessagesCount;t.default=Object(m.d)(Object(l.b)((function(e){return{messages:Object(i.d)(e),dialogs:Object(i.b)(e),lastUserActivityDate:Object(i.c)(e),deletedMessages:Object(i.a)(e),spamedMessages:Object(i.h)(e),selectedFriend:Object(i.g)(e),currentUserInfo:Object(c.c)(e),messagesLoading:Object(i.e)(e)}}),{sendMessage:fe,getDialogs:he,getMessages:ve,deleteMessage:xe,spamMessage:we,restoreMessage:je,requestNewMessagesCount:Ee}),d.a)((function(e){var t=e.getDialogs,a=Object(n.a)(e,["getDialogs"]),o=Object(be.i)().id;return Object(s.useEffect)((function(){return t(),re.d.on("get_new_message",t),function(){re.d.off("get_new_message",t)}}),[t]),r.a.createElement(ue,Object.assign({},a,{getDialogs:t,friendId:Number(o)}))}))},497:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(3),s=a(13),r=a(0),o=a.n(r),i=a(223),c=a(636),l=a(625),d=a(639),m=a(626),g=["text","email","search","password","textarea"],p=Object(i.a)((function(e){return{textInput:{marginBottom:25,"& .MuiFormHelperText-root":Object(s.a)({fontSize:10,position:"absolute",bottom:0,transform:"translateY(100%)"},e.breakpoints.up("sm"),{fontSize:12})}}})),u=function(e){var t=e.input,a=e.label,s=e.type,r=e.meta,i=r.touched,u=r.error,b=Object(n.a)(e,["input","label","type","meta"]),f=p();return o.a.createElement(o.a.Fragment,null,g.includes(s)&&o.a.createElement(c.a,Object.assign({error:i&&Boolean(u),helperText:i&&u?u:"",label:a,type:s,fullWidth:!0,className:f.textInput},t,b)),"checkbox"===s&&o.a.createElement(l.a,{className:f.textInput,control:o.a.createElement(d.a,{checked:!!t.value,onChange:t.onChange}),label:a}),"switch"===s&&o.a.createElement(l.a,{className:f.textInput,control:o.a.createElement(m.a,{checked:!!t.value,onChange:t.onChange}),label:a}))}},500:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(80),s=a(59),r=a(143),o=a(144),i=a(145),c=a(0),l=a.n(c),d=a(72),m=a(62),g=a(58),p=a(34),u=function(e){return{isAuth:Object(g.e)(e)}},b=function(e){var t=function(t){function a(){return Object(n.a)(this,a),Object(r.a)(this,Object(o.a)(a).apply(this,arguments))}return Object(i.a)(a,t),Object(s.a)(a,[{key:"render",value:function(){return this.props.isAuth?l.a.createElement(e,this.props):l.a.createElement(d.a,{to:p.a.login.path})}}]),a}(c.Component);return Object(m.b)(u)(t)}},604:function(e,t,a){e.exports=a.p+"static/media/read.3f77ca25.svg"},605:function(e,t,a){e.exports=a.p+"static/media/unread.4cd435c4.svg"},606:function(e,t,a){e.exports=a.p+"static/media/chat-bg.6cc5a933.svg"}}]);
//# sourceMappingURL=MessagesContainer.a2caab1b.chunk.js.map